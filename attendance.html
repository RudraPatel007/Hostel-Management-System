<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Attendance Dashboard - Filtered</title>
    <style>
        /* --- CSS STYLES --- (Retained from previous version, added input styling) */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
        }

        .dashboard-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* --- Input Filter Styling --- */
        .filter-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: #f0f8ff; /* Light Blue background for contrast */
        }

        .filter-section input[type="text"] {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            flex-grow: 1;
            max-width: 250px;
        }

        .filter-section button {
            padding: 8px 15px;
            background-color: #4a6fa5;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .filter-section button:hover {
            background-color: #3b5585;
        }

        #message {
            color: #e53935; /* Red for error messages */
            font-weight: bold;
            margin-left: 10px;
            align-self: center;
        }

        /* --- Header Metrics --- */
        .metrics-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .metric-box {
            color: #fff;
            padding: 15px 20px;
            border-radius: 6px;
            text-align: center;
            flex: 1;
            margin: 0 5px;
            font-weight: bold;
            font-size: 1.1em;
        }

        .metric-box:first-child { margin-left: 0; }
        .metric-box:last-child { margin-right: 0; }

        .present-percent { background-color: #00bcd4; } 
        .total-count { background-color: #e91e63; }    
        .present-count { background-color: #00c853; }  
        .absent-count { background-color: #ff9800; }   

        /* --- Table Layout & Styling --- */
        .attendance-table-wrapper {
            overflow-x: auto;
        }

        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            min-width: 1000px; 
        }

        .attendance-table th, .attendance-table td {
            border: 1px solid #e0e0e0;
            padding: 8px;
            text-align: center;
        }

        .attendance-table th {
            background-color: #4a6fa5; 
            color: #fff;
            font-weight: normal;
        }
        
        /* Sticky Roll No and Name Columns - Important for horizontal scrolling */
        .attendance-table th:nth-child(1), .attendance-table td:nth-child(1),
        .attendance-table th:nth-child(2), .attendance-table td:nth-child(2) {
            position: sticky;
            left: 0;
            background-color: #fff;
            z-index: 10;
        }

        .attendance-table th:nth-child(1), .attendance-table th:nth-child(2) {
             background-color: #4a6fa5;
        }
        
        .attendance-table tr:nth-child(even) td {
            background-color: #f9f9f9;
        }

        .day-column-highlight {
            background-color: #fff9c4 !important; 
        }

        .check {
            color: #00c853; 
            font-weight: bold;
        }

        .cross {
            color: #e53935; 
            font-weight: bold;
        }

        .icon-column {
            font-size: 1.1em;
            line-height: 1;
        }

        .summary-header {
             background-color: #7986cb !important;
        }
    </style>
</head>
<body>

<div class="dashboard-container">
    <h2>Division Register</h2>

    <div class="filter-section">
        <label for="studentIdInput">Enter Student Roll ID:</label>
        <input type="text" id="studentIdInput" placeholder="e.g., 501">
        <button onclick="filterAttendance()">Show Attendance</button>
        <button onclick="resetTable()">Show All Students</button>
        <span id="message"></span>
    </div>
    
    <div class="metrics-bar" id="metricsBar">
        </div>

    <div class="attendance-table-wrapper">
        <table class="attendance-table">
            <thead id="tableHeader">
                </thead>
            <tbody id="tableBody">
                </tbody>
        </table>
    </div>
</div>

<script>
    // --- JAVASCRIPT LOGIC ---

    const TOTAL_MONTH_DAYS = 30; 
    const STUDENT_STRENGTH = 10; // Total count of students defined below

    // 1. Defined Data Structure (Students with pre-defined attendance for demonstration)
    const allStudentsData = [
        { id: 501, name: "SUHANI CHAUHAN", presentDays: 20, absentDays: 2, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] },
        { id: 502, name: "SUMAS CHAUHAN", presentDays: 18, absentDays: 4, attendance: ['P','A','P','P','P','P','P','P','P','P','P','P','P','A','P','P','P','P','P','P'] },
        { id: 503, name: "SUMEET CHAUHAN", presentDays: 22, absentDays: 0, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] },
        { id: 504, name: "SUMIT CHAUHAN", presentDays: 15, absentDays: 7, attendance: ['A','P','A','P','A','P','A','P','A','P','A','P','A','P','A','P','A','P','A','P'] },
        { id: 505, name: "SUNIL CHAUHAN", presentDays: 19, absentDays: 3, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] },
        { id: 506, name: "SUNIL CHAUHAN", presentDays: 19, absentDays: 3, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] },
        { id: 507, name: "SURAJ CHAUHAN", presentDays: 19, absentDays: 3, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] },
        { id: 508, name: "SURAJ CHAUHAN", presentDays: 19, absentDays: 3, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] },
        { id: 509, name: "SUMAS CHAUHAN", presentDays: 19, absentDays: 3, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] },
        { id: 510, name: "SUNIL CHAUHAN", presentDays: 19, absentDays: 3, attendance: ['P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P','P'] }
    ];

    // Function to populate the main table
    function populateTable(studentsToDisplay) {
        const tableHeader = document.getElementById('tableHeader');
        const tableBody = document.getElementById('tableBody');
        tableBody.innerHTML = ''; // Clear existing rows

        // --- Generate Table Header (Only needs to run once, but included here for completeness) ---
        if (tableHeader.children.length === 0) {
            let headerHTML = '<tr>';
            headerHTML += '<th rowspan="2">Roll Id</th>';
            headerHTML += '<th rowspan="2">Name</th>';
            
            // Day numbers 1 to 20
            for (let i = 1; i <= 20; i++) {
                headerHTML += <th colspan="1">${i}</th>;
            }
            
            headerHTML += '<th rowspan="2" class="summary-header">Student Strength</th>';
            headerHTML += '<th rowspan="2" class="summary-header">Total Present Days of Month</th>';
            headerHTML += '<th rowspan="2" class="summary-header">Present Upto This Month</th>';
            headerHTML += '<th rowspan="2" class="summary-header">Absent Upto This Month</th>';
            headerHTML += '<th rowspan="2" class="summary-header">Total Att. This Month</th>';
            
            headerHTML += '</tr>';
            
            headerHTML += '<tr>';
            for (let i = 1; i <= 20; i++) {
                headerHTML += <th class="day-column-highlight"></th>;
            }
            headerHTML += '</tr>';
            tableHeader.innerHTML = headerHTML;
        }

        // --- Generate Table Body (Data Rows) ---
        let bodyHTML = '';
        studentsToDisplay.forEach(student => {
            // Summary calculations (using mock-up values from the original image for the totals)
            const presentUptoMonth = student.presentDays * (studentsToDisplay.length > 1 ? 1 : allStudentsData.length);
            const absentUptoMonth = student.absentDays * (studentsToDisplay.length > 1 ? 1 : allStudentsData.length);
            const totalAttThisMonth = presentUptoMonth + absentUptoMonth;

            // Mocked-up 'Total Present Days of Month' (usually a calendar constant)
            const totalCalendarDays = 22; 

            bodyHTML += <tr>;
            bodyHTML += <td>${student.id}</td>;
            bodyHTML += <td style="text-align: left;">${student.name}</td>;
            
            // Daily Attendance (20 days)
            student.attendance.forEach((status, index) => {
                const icon = status === 'P' ? '✓' : '✗';
                const iconClass = status === 'P' ? 'check' : 'cross';
                // Apply the yellow highlight class
                const highlightClass = (index + 1) >= 9 && (index + 1) <= 20 ? 'day-column-highlight' : ''; 
                
                bodyHTML += <td class="icon-column ${highlightClass}"><span class="${iconClass}">${icon}</span></td>;
            });

            // Summary Columns (Right Side)
            bodyHTML += <td class="summary-header">${STUDENT_STRENGTH}</td>;
            bodyHTML += <td class="summary-header">${totalCalendarDays}</td>;
            bodyHTML += <td class="summary-header">${presentUptoMonth}</td>;
            bodyHTML += <td class="summary-header">${absentUptoMonth}</td>;
            bodyHTML += <td class="summary-header">${totalAttThisMonth}</td>;
            
            bodyHTML += </tr>;
        });
        
        tableBody.innerHTML = bodyHTML;
    }

    // Function to calculate and populate the top metrics bar
    function populateMetrics() {
        // Calculate aggregate metrics for ALL students (assuming initial view is 'Show All')
        const totalPresents = allStudentsData.reduce((sum, s) => sum + s.presentDays, 0);
        const totalAbsents = allStudentsData.reduce((sum, s) => sum + s.absentDays, 0);
        const totalAttendance = totalPresents + totalAbsents;
        const presentPercent = totalAttendance > 0 ? Math.round((totalPresents / totalAttendance) * 100) : 0;

        const metricsBar = document.getElementById('metricsBar');
        metricsBar.innerHTML = `
            <div class="metric-box present-percent">
                ${presentPercent}%<br>Present %
            </div>
            <div class="metric-box total-count">
                ${totalAttendance}<br>Total Count
            </div>
            <div class="metric-box present-count">
                ${totalPresents}<br>Present Count
            </div>
            <div class="metric-box absent-count">
                ${totalAbsents}<br>Absent Count
            </div>
        `;
    }

    // NEW: Function to filter the table by Student ID
    function filterAttendance() {
        const inputId = document.getElementById('studentIdInput').value.trim();
        const messageElement = document.getElementById('message');
        messageElement.textContent = ''; // Clear previous messages

        if (!inputId) {
            messageElement.textContent = 'Please enter a Student Roll ID.';
            return;
        }

        const studentId = parseInt(inputId);
        const filteredStudent = allStudentsData.find(student => student.id === studentId);

        if (filteredStudent) {
            populateTable([filteredStudent]); // Display only the filtered student
        } else {
            messageElement.textContent = Student ID $;{inputId} not found;
            // Optionally, clear the table if no student is found
            document.getElementById('tableBody').innerHTML = '<tr><td colspan="25" style="padding: 20px;">No student found with that ID.</td></tr>';
        }
    }

    // NEW: Function to reset the table to show all students
    function resetTable() {
        document.getElementById('studentIdInput').value = '';
        document.getElementById('message').textContent = '';
        populateTable(allStudentsData);
        populateMetrics(); // Re-calculate/display aggregate metrics
    }

    // Initialize the dashboard on load
    document.addEventListener('DOMContentLoaded', () => {
        resetTable(); // Start by showing all students
    });

</script>
</body>
</html>